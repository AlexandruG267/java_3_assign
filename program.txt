#In the think step, your agent evaluates the program rules.
#It does so by doing inference on the union of the program rules (this file) and the belief base.
#The program rules define how and when actions need to be added to the intentions, goals need to be addopted and beliefs needs to be added or deleted
#Actions are defined by the operators +-*~_. See the assignment for an explanantion of these operators.
#The conditions of a rule are the preconditions, just like any other rule. The conclusion of the rule contains the action(s) and/or facts that can be derived with inference.
#Actions are not used during inference as new facts (i.e., they cannot unify with the knowledge base), 
#They are processed by the agent as new facts into the appropriate knowledge bases (beliefs, desires, intentions).
#The exception is the addition action, of which the predicate is added to the facts during inference.
#Add your program rules below:

# Open door at a location X if we have an appropriate key
# Note: haveKey() fact is added to KB in the act cycle
agentAt(X) & lockedDoor(X,D) & haveKey(K) > _open(X,D,K)

# If we are at the same location as a key, grab the key
agentAt(X) & keyAt(X,K) > _grab(X,K)

# If we can follow a link, do
# The visited(X) is iffy, the problem is that it would add goto to both directions otherwise, remove it and see what happens
agentAt(X) & link(X,Y) & visited(X) > _goto(X,Y)



# Goal 1: get any known key we don't have yet
keyAt(L,K) & !haveKey(K) > *haveKey(K)

# Goal 2: open a locked door at our current location (once opened, mark it so the goal can be satisfied)
agentAt(X) & lockedDoor(X,D) & haveKey(K) & !opened(X,D) > *opened(X,D)

# Goal 3: explore by moving to an unvisited neighbor
agentAt(X) & link(X,Y) & !visited(Y) > *agentAt(Y)

# testing: move to a closed door
haveKey(K) & lockedDoor(L,K) & !opened(L,K) > *agentAt(L)